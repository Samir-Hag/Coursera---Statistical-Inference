---
title: "Part Two: Basic inferential data analysis"
author: "Samir N. Hag Ibrahim"
date: "7/12/2020"
output: pdf_document
---
# PART TWO:BASIC INFERENTIAL DADA ANALYSIS
## 1. Load the data and perform basic EDA.
first, laod the libraries and the dataset
```{r include=FALSE}
library(ggplot2)
library(DataExplorer)
library(mlbench)
#library(skimr)
library(dplyr)
data("ToothGrowth")
```
EDA is useful to get a glimpse of the provided data. EDA was performed as follow:

### Data Validation and quality
#### A. data structure
```{r echo=FALSE}
str(ToothGrowth); names(ToothGrowth)
```
The dataset is made up of 60 observation and 3 variables namely: "len", "supp" and "dose". in the dataset,we have 2 numeric variables and 1 categorical variable with two levels ("OJ" and "VC") and no missing values were recorded.

#### B. Missing Values
```{r echo=FALSE, eval=FALSE}
sum(is.na(ToothGrowth))
```
Accordingly, there is no missing values in the dataset.

#### C. Data summary
for more details about the dataset
```{r echo=FALSE, eval=FALSE}
summary(ToothGrowth)
#skim(ToothGrowth)
```
The dataset contains 2 numeric variables and 1 factor variable (with 2 levels) each with 60 observation and no missing values recorded. chacking the frequency of the catergorical variables "supplement":
```{r echo=FALSE}
with(ToothGrowth, table(supp))
```
 we have 30 obervations for each level. Now plot the frequencies.
```{r echo=FALSE,fig.height = 2, fig.width = 4, fig.align = "center"}
plot_histogram(ToothGrowth, ggtheme = theme_bw())
```
it seems that the dose should be considered as a _Factor_ variable and not numeric variable.
we need to convert dose variable into _Factor_.
```{r echo=FALSE}
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
```

```{r echo=FALSE, eval=FALSE}
plot_bar(ToothGrowth, ggtheme = theme_bw())
```
Accordingly, we have 2 supp levels (30 obs each) and 3 dose levels (20 obs each). sounds like we have 10 obs per dose for each supp. to check this:
```{r echo=FALSE}
table(ToothGrowth$dose, ToothGrowth$supp)
```
#### D. effect on tooth length
```{r echo=FALSE, fig.height = 2, fig.width = 4, fig.align = "center"}
ggplot(ToothGrowth, aes(x = supp, y = len))+
        geom_boxplot(aes(fill = supp))+
        facet_wrap(. ~dose)+
        theme_bw()
```
So, the over all conclusion from EDA is that:
1. There are 3 variables (2 numeric and 1 categorical)
2. _dose_ variable was set as a numeric variable where it is actually a _Factor_.
3. There are 10 obs per dose for each supplement.
4. There is no missing values in the data set.
5. Possibly there an effect of dose on the  tooth growth, since increasing the dose leads to an increase in the teeth legnth, but it is not yet clear if there is an effect of supplement type on that.

## 2. Provide a basic summary of the data
Here bellow is the statistical summary of the data.
```{r include=FALSE}
library(pastecs)
summary(ToothGrowth)
stat_tooth <- stat.desc(ToothGrowth)
```
## 3. Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose
### A- t-test
#### I- Effect of Supplement on Toothgrowth
```{r echo=FALSE}
t.test_supp <- t.test(data=ToothGrowth, len~supp, paired = FALSE)
t.test_supp
```
According to the t-test,  the p-value for`r t.test_supp$data.name`  was found to be `r t.test_supp$p.value` "i.e. _p>0.05_", therefore, we can not reject the null hypothesis (i.e. there is no differece between the means). But since _p -value < 0.1, so, we can not be sure if the we truely can reject the null hypothesis, therefore, the power was calculated in the next section.

#### II- The effect of DOSE on Toothgrowth
Since we have 3 levels for _dose_, we will subset the main dataset into 3 subsets
```{r echo=FALSE}
d1 <- ToothGrowth[ToothGrowth$dose == c(0.5, 1), ]
d2 <- ToothGrowth[ToothGrowth$dose == c(0.5, 2), ]
d3 <- ToothGrowth[ToothGrowth$dose == c(1, 2), ]
```

```{r echo=FALSE}
t.test_d1<- t.test(data = d1, len~dose, paired = FALSE)
t.test_d2<- t.test(data = d2, len~dose, paired = FALSE)
t.test_d3<- t.test(data = d2, len~dose, paired = FALSE)
t.test_dose <- as.data.frame(row.names = "p-value", cbind("Dose 0.5 & 1" = t.test_d1$p.value,"Dose 0.5 & 2" = t.test_d2$p.value, "Dose 1 & 2" = t.test_d3$p.value))
t.test_dose
```
from the t.test, there was a significant difference between all doses examined and the teeth length (i.e. the dose has a significnat effect on the teeth length).

### B- power:
*Power* was used here to evaluate the power ( or probability ) of rejecting the null hypothesis "that there is a significant difference between the means of _supp_" under the current test conditions. 
```{r include=FALSE}
stat_OJ <- stat.desc(ToothGrowth[ToothGrowth$supp == "OJ", ])
stat_VC <- stat.desc(ToothGrowth[ToothGrowth$supp == "VC", ])

```
*Tets conditions:*
number of samples = 30 for each treatment, 
the difference between the means is 3.7
sd of the data = 7.64
```{r include=FALSE}
power_supp <- power.t.test(n=30, delta = stat_OJ$len[9]-stat_VC$len[9], sd= stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_supp
```
Accordingly, under the current stats, there is `r round(power_supp$power * 100,2)`% probability to reject the null hypothesis (relatively low probability for reject the null hypothesis). in order to increase this probability, we have either one of two options:
1- increase the number of samples
2- increase delta (i.e. the means difference)

#### I- Number of samples 
what is the number of samples required that can increase the probability (up to 80%) for rejecting the null hypothesis???
```{r include = FALSE}
power_n <- power.t.test(power = 0.8, delta = stat_OJ$len[9]-stat_VC$len[9], sd = stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_n$n
```
Accordingly,  we need `r round(power_n$n)` sample (compared with the current no. of observation '30') to increase the probability of rejecting the null hypothesis up to 80%.

#### II- Increase delta
Also we can increase the power of rejecting the null hypothesis if the means difference increased. 
```{r include=FALSE}
power_delta <- power.t.test(power = 0.8, n=30, sd = stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_delta
```
from the calculations above, we can observe that the mininum value of _delta_ at which there is `r power_delta$power * 100` % probability for rejecting the null hypothesis is `r round(power_delta$delta, 2)`. This value is greater that the actual means difference `r round(power_supp$delta, 2)`. Hence, the only possible way to increase the probability of rejecting the null hypothesis is by increaseing the number of observations up to `r round(power_n$n)` sample.

\newpage

# APPENDIX

## Codes

```{r eval=FALSE}
library(ggplot2)
library(DataExplorer)
library(mlbench)
#library(skimr)
library(dplyr)
data("ToothGrowth")
```


```{r eval=FALSE}
str(ToothGrowth); names(ToothGrowth)
```

```{r eval=FALSE}
sum(is.na(ToothGrowth))
```


```{r eval=FALSE}
summary(ToothGrowth)
```


```{r eval=FALSE}
with(ToothGrowth, table(supp))
```
 
```{r eval=FALSE}
plot_histogram(ToothGrowth, ggtheme = theme_bw())
```


```{r eval=FALSE}
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
```

```{r fig.height = 2, fig.width = 4, fig.align = "center"}
plot_bar(ToothGrowth, ggtheme = theme_bw())
```

```{r eval=FALSE}
table(ToothGrowth$dose, ToothGrowth$supp)
```
 
```{r eval=FALSE}
ggplot(ToothGrowth, aes(x = supp, y = len))+
        geom_boxplot(aes(fill = supp))+
        facet_wrap(. ~dose)+
        theme_bw()
```


```{r eval=FALSE}
library(pastecs)
summary(ToothGrowth)
stat_tooth <- stat.desc(ToothGrowth)
```

```{r eval=FALSE}
t.test_supp <- t.test(data=ToothGrowth, len~supp, paired = FALSE)
t.test_supp
```

```{r eval=FALSE}
d1 <- ToothGrowth[ToothGrowth$dose == c(0.5, 1), ]
d2 <- ToothGrowth[ToothGrowth$dose == c(0.5, 2), ]
d3 <- ToothGrowth[ToothGrowth$dose == c(1, 2), ]

```

```{r eval=FALSE}
t.test_d1<- t.test(data = d1, len~dose, paired = FALSE)
t.test_d2<- t.test(data = d2, len~dose, paired = FALSE)
t.test_d3<- t.test(data = d2, len~dose, paired = FALSE)
t.test_dose <- as.data.frame(row.names = "p-value", cbind("Dose 0.5 & 1" = t.test_d1$p.value,"Dose 0.5 & 2" = t.test_d2$p.value, "Dose 1 & 2" = t.test_d3$p.value))
t.test_dose
```

```{r eval=FALSE}
stat_OJ <- stat.desc(ToothGrowth[ToothGrowth$supp == "OJ", ])
stat_VC <- stat.desc(ToothGrowth[ToothGrowth$supp == "VC", ])

```


```{r eval=FALSE}
power_supp <- power.t.test(n=30, delta = stat_OJ$len[9]-stat_VC$len[9], sd= stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_supp
```


```{r eval=FALSE}
power_n <- power.t.test(power = 0.8, delta = stat_OJ$len[9]-stat_VC$len[9], sd = stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_n$n
```

```{r eval=FALSE}
power_delta <- power.t.test(power = 0.8, n=30, sd = stat_tooth$len[13], type = "two.sample", alternative = "one.sided")
power_delta
```


#### DONE **********************